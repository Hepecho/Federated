Namespace(action=5, all_clients=False, bs=128, dataset='mnist', epochs=10, frac=0.1, gpu=0, iid=False, kernel_num=9, kernel_sizes='3,4,5', local_bs=10, local_ep=5, lr=0.01, max_pool='True', model='CNN', momentum=0.5, norm='batch_norm', num_channels=3, num_classes=10, num_filters=32, num_users=100, seed=1, split='user', stopping_rounds=10, verbose=False)
{'model_name': 'CNN', 'device': device(type='cuda', index=0), 'log_dir': 'log\\CNN', 'ckpt_dir': 'checkpoint\\CNN', 'mode': 'lf', 'defence': 'raw', 'client_epochs': 10, 'server_epochs': 100, 'batch_size': 100, 'client_lr': 0.15, 'server_lr': 0.15, 'server_rate': 2000, 'load_ckpt': 0, 'workers': 20, 'byzantine_workers': 8, 'attack_strength': 0.01, 'k': 1, 'b': 4, 'test_frequency': 1}
======================Start Train Model [Sun May  5 09:58:43 2024]======================
Namespace(action=5, all_clients=False, bs=128, dataset='mnist', epochs=10, frac=0.1, gpu=0, iid=False, kernel_num=9, kernel_sizes='3,4,5', local_bs=10, local_ep=5, lr=0.01, max_pool='True', model='CNN', momentum=0.5, norm='batch_norm', num_channels=3, num_classes=10, num_filters=32, num_users=100, seed=1, split='user', stopping_rounds=10, verbose=False)
{'model_name': 'CNN', 'device': device(type='cuda', index=0), 'log_dir': 'log\\CNN', 'ckpt_dir': 'checkpoint\\CNN', 'mode': 'lf', 'defence': 'raw', 'client_epochs': 10, 'server_epochs': 100, 'batch_size': 100, 'client_lr': 0.15, 'server_lr': 0.15, 'server_rate': 2000, 'load_ckpt': 0, 'workers': 20, 'byzantine_workers': 8, 'attack_strength': 0.01, 'k': 1, 'b': 4, 'test_frequency': 1}
======================Start Train Model [Sun May  5 09:59:01 2024]======================
Epoch: 1 | Epoch Time: 0m 56s
Train Loss: 2.2986134774780274 | Train Acc: 10.001999884843826%
Test Loss: 2.298537055969238 | Test Acc: 10.000000149011612%
Epoch: 2 | Epoch Time: 0m 57s
Train Loss: 2.2919910583496095 | Train Acc: 15.0859996676445%
Test Loss: 2.291854035949707 | Test Acc: 15.170000493526459%
Epoch: 3 | Epoch Time: 0m 58s
Train Loss: 2.2814952407836913 | Train Acc: 16.364000737667084%
Test Loss: 2.2812741638183596 | Test Acc: 16.449999809265137%
Epoch: 4 | Epoch Time: 0m 58s
Train Loss: 2.2669888497924804 | Train Acc: 19.923999905586243%
Test Loss: 2.2666563247680664 | Test Acc: 20.37999927997589%
Epoch: 5 | Epoch Time: 0m 56s
Train Loss: 2.2491241455078126 | Train Acc: 23.029999434947968%
Test Loss: 2.248658383178711 | Test Acc: 23.520000278949738%
Epoch: 6 | Epoch Time: 0m 55s
Train Loss: 2.227961781311035 | Train Acc: 25.15600025653839%
Test Loss: 2.2273544692993164 | Test Acc: 25.909999012947083%
Epoch: 7 | Epoch Time: 0m 55s
Train Loss: 2.2047721701049805 | Train Acc: 27.22199857234955%
Test Loss: 2.2039799392700195 | Test Acc: 27.84000039100647%
Epoch: 8 | Epoch Time: 0m 55s
Train Loss: 2.1785021728515623 | Train Acc: 29.13999855518341%
Test Loss: 2.177522622680664 | Test Acc: 29.6099990606308%
Epoch: 9 | Epoch Time: 0m 55s
Train Loss: 2.1506564584350585 | Train Acc: 30.608001351356506%
Test Loss: 2.1494090072631837 | Test Acc: 30.779999494552612%
Epoch: 10 | Epoch Time: 0m 56s
Train Loss: 2.1217932516479494 | Train Acc: 31.643998622894287%
Test Loss: 2.1202668441772463 | Test Acc: 31.760001182556152%
Epoch: 11 | Epoch Time: 0m 55s
Train Loss: 2.0924244232177736 | Train Acc: 32.513999938964844%
Test Loss: 2.0906444046020507 | Test Acc: 32.83999860286713%
Epoch: 12 | Epoch Time: 0m 59s
Train Loss: 2.061774895019531 | Train Acc: 33.296000957489014%
Test Loss: 2.0597425186157228 | Test Acc: 33.61000120639801%
Epoch: 13 | Epoch Time: 1m 2s
Train Loss: 2.0313998654174803 | Train Acc: 34.01400148868561%
Test Loss: 2.0290857055664064 | Test Acc: 34.47999954223633%
Epoch: 14 | Epoch Time: 1m 0s
Train Loss: 2.002354407043457 | Train Acc: 34.74999964237213%
Test Loss: 1.9997940551757813 | Test Acc: 35.24999916553497%
Epoch: 15 | Epoch Time: 0m 59s
Train Loss: 1.9725496524047852 | Train Acc: 35.346001386642456%
Test Loss: 1.9697989395141602 | Test Acc: 36.01999878883362%
Epoch: 16 | Epoch Time: 0m 58s
Train Loss: 1.9453806176757813 | Train Acc: 35.98200082778931%
Test Loss: 1.9424260864257812 | Test Acc: 36.44999861717224%
Epoch: 17 | Epoch Time: 0m 59s
Train Loss: 1.9184695849609374 | Train Acc: 36.489999294281006%
Test Loss: 1.9154308776855469 | Test Acc: 37.16000020503998%
Epoch: 18 | Epoch Time: 0m 59s
Train Loss: 1.8916766976928712 | Train Acc: 36.956000328063965%
Test Loss: 1.8884475662231446 | Test Acc: 37.49000132083893%
Epoch: 19 | Epoch Time: 0m 59s
Train Loss: 1.8688515747070313 | Train Acc: 37.450000643730164%
Test Loss: 1.8654260437011718 | Test Acc: 37.74000108242035%
Epoch: 20 | Epoch Time: 1m 1s
Train Loss: 1.8437918142700196 | Train Acc: 37.992000579833984%
Test Loss: 1.8402478668212892 | Test Acc: 38.17000091075897%
Epoch: 21 | Epoch Time: 1m 1s
Train Loss: 1.8210467736816407 | Train Acc: 38.444000482559204%
Test Loss: 1.817378419494629 | Test Acc: 38.49000036716461%
Epoch: 22 | Epoch Time: 0m 57s
Train Loss: 1.80070820892334 | Train Acc: 38.77600133419037%
Test Loss: 1.7969346267700195 | Test Acc: 38.78999948501587%
Epoch: 23 | Epoch Time: 0m 55s
Train Loss: 1.7794267474365235 | Train Acc: 39.2300009727478%
Test Loss: 1.7755987991333009 | Test Acc: 39.25999999046326%
Epoch: 24 | Epoch Time: 0m 54s
Train Loss: 1.7600682586669922 | Train Acc: 39.47399854660034%
Test Loss: 1.7561814834594727 | Test Acc: 39.410001039505005%
Epoch: 25 | Epoch Time: 0m 59s
Train Loss: 1.7411218411254883 | Train Acc: 39.84000086784363%
Test Loss: 1.7372755645751954 | Test Acc: 40.049999952316284%
Epoch: 26 | Epoch Time: 0m 57s
Train Loss: 1.7230799221801758 | Train Acc: 40.220001339912415%
Test Loss: 1.7193090637207031 | Test Acc: 40.36000072956085%
Epoch: 27 | Epoch Time: 0m 57s
Train Loss: 1.7070035961914063 | Train Acc: 40.553998947143555%
Test Loss: 1.7032832122802735 | Test Acc: 40.59999883174896%
Epoch: 28 | Epoch Time: 0m 52s
Train Loss: 1.6909331549072266 | Train Acc: 40.87199866771698%
Test Loss: 1.6873396408081054 | Test Acc: 40.860000252723694%
Epoch: 29 | Epoch Time: 0m 58s
Train Loss: 1.678259402770996 | Train Acc: 41.13200008869171%
Test Loss: 1.6747246154785156 | Test Acc: 40.950000286102295%
Epoch: 30 | Epoch Time: 0m 58s
Train Loss: 1.6614421725463868 | Train Acc: 41.600000858306885%
Test Loss: 1.658068409729004 | Test Acc: 41.33000075817108%
Epoch: 31 | Epoch Time: 0m 51s
Train Loss: 1.6479041937255858 | Train Acc: 41.99000000953674%
Test Loss: 1.644617739868164 | Test Acc: 41.89000129699707%
Epoch: 32 | Epoch Time: 0m 51s
Train Loss: 1.6335332986450195 | Train Acc: 42.399999499320984%
Test Loss: 1.630378762817383 | Test Acc: 42.28000044822693%
Epoch: 33 | Epoch Time: 0m 47s
Train Loss: 1.619634398803711 | Train Acc: 42.80399978160858%
Test Loss: 1.6165624481201173 | Test Acc: 42.71999895572662%
Epoch: 34 | Epoch Time: 0m 59s
Train Loss: 1.6093909619140625 | Train Acc: 43.02600026130676%
Test Loss: 1.6066592330932616 | Test Acc: 43.09999942779541%
Epoch: 35 | Epoch Time: 0m 55s
Train Loss: 1.5975826843261718 | Train Acc: 43.41999888420105%
Test Loss: 1.5952861679077148 | Test Acc: 43.50000023841858%
Epoch: 36 | Epoch Time: 0m 49s
Train Loss: 1.5856895095825196 | Train Acc: 43.790000677108765%
Test Loss: 1.5837200714111328 | Test Acc: 43.939998745918274%
Epoch: 37 | Epoch Time: 0m 47s
Train Loss: 1.5739537768554688 | Train Acc: 44.1540002822876%
Test Loss: 1.5722318359375 | Test Acc: 44.269999861717224%
Epoch: 38 | Epoch Time: 0m 54s
Train Loss: 1.5632283251953125 | Train Acc: 44.457998871803284%
Test Loss: 1.561906719970703 | Test Acc: 44.4599986076355%
Epoch: 39 | Epoch Time: 0m 55s
Train Loss: 1.5519119381713866 | Train Acc: 44.79399919509888%
Test Loss: 1.5508244659423829 | Test Acc: 44.9099987745285%
Epoch: 40 | Epoch Time: 1m 1s
Train Loss: 1.5414326046752929 | Train Acc: 45.19200026988983%
Test Loss: 1.5407718811035156 | Test Acc: 45.14000117778778%
Epoch: 41 | Epoch Time: 0m 52s
Train Loss: 1.5304166177368164 | Train Acc: 45.49799859523773%
Test Loss: 1.530163931274414 | Test Acc: 45.42999863624573%
Epoch: 42 | Epoch Time: 0m 58s
Train Loss: 1.520926378173828 | Train Acc: 45.848000049591064%
Test Loss: 1.5209577682495117 | Test Acc: 45.78999876976013%
Epoch: 43 | Epoch Time: 1m 0s
Train Loss: 1.5134872586059571 | Train Acc: 46.0860013961792%
Test Loss: 1.5138811904907226 | Test Acc: 46.03999853134155%
Epoch: 44 | Epoch Time: 0m 57s
Train Loss: 1.5042840283203125 | Train Acc: 46.40800058841705%
Test Loss: 1.5050143646240235 | Test Acc: 46.43999934196472%
Epoch: 45 | Epoch Time: 0m 50s
Train Loss: 1.4966740985107423 | Train Acc: 46.63200080394745%
Test Loss: 1.4978211822509766 | Test Acc: 46.61000072956085%
Epoch: 46 | Epoch Time: 0m 48s
Train Loss: 1.4887571591186524 | Train Acc: 46.90200090408325%
Test Loss: 1.4902069137573242 | Test Acc: 46.77000045776367%
Epoch: 47 | Epoch Time: 0m 49s
Train Loss: 1.4795852587890626 | Train Acc: 47.200000286102295%
Test Loss: 1.4813270065307618 | Test Acc: 47.09999859333038%
Epoch: 48 | Epoch Time: 0m 59s
Train Loss: 1.4703605131530761 | Train Acc: 47.56799936294556%
Test Loss: 1.4724334907531738 | Test Acc: 47.54000008106232%
Epoch: 49 | Epoch Time: 0m 57s
Train Loss: 1.4624433935546874 | Train Acc: 47.826001048088074%
Test Loss: 1.4648534408569336 | Test Acc: 47.760000824928284%
Epoch: 50 | Epoch Time: 0m 47s
Train Loss: 1.4555303825378418 | Train Acc: 48.04199934005737%
Test Loss: 1.4583326637268066 | Test Acc: 48.019999265670776%
Epoch: 51 | Epoch Time: 0m 48s
Train Loss: 1.4485349223327637 | Train Acc: 48.26200008392334%
Test Loss: 1.4517592376708985 | Test Acc: 48.19999933242798%
Epoch: 52 | Epoch Time: 0m 48s
Train Loss: 1.4396125257873535 | Train Acc: 48.579999804496765%
Test Loss: 1.4432635749816896 | Test Acc: 48.669999837875366%
Epoch: 53 | Epoch Time: 0m 47s
Train Loss: 1.4313178025817872 | Train Acc: 48.81199896335602%
Test Loss: 1.4353203254699707 | Test Acc: 48.87000024318695%
Epoch: 54 | Epoch Time: 0m 48s
Train Loss: 1.4246117324829102 | Train Acc: 49.05000030994415%
Test Loss: 1.4287856781005859 | Test Acc: 49.140000343322754%
Epoch: 55 | Epoch Time: 0m 47s
Train Loss: 1.417234425354004 | Train Acc: 49.362000823020935%
Test Loss: 1.4219308532714843 | Test Acc: 49.320000410079956%
Epoch: 56 | Epoch Time: 0m 47s
Train Loss: 1.4124796408081055 | Train Acc: 49.483999609947205%
Test Loss: 1.4178339179992676 | Test Acc: 49.52000081539154%
Epoch: 57 | Epoch Time: 0m 46s
Train Loss: 1.4063117665100098 | Train Acc: 49.625998735427856%
Test Loss: 1.4121537590026856 | Test Acc: 49.68999922275543%
Epoch: 58 | Epoch Time: 0m 48s
Train Loss: 1.3990610295104982 | Train Acc: 49.869999289512634%
Test Loss: 1.4053550941467285 | Test Acc: 49.810001254081726%
Epoch: 59 | Epoch Time: 0m 48s
Train Loss: 1.393513649597168 | Train Acc: 50.07399916648865%
Test Loss: 1.4002547004699708 | Test Acc: 50.029999017715454%
Epoch: 60 | Epoch Time: 0m 48s
Train Loss: 1.3875336309814452 | Train Acc: 50.34400224685669%
Test Loss: 1.394788996887207 | Test Acc: 50.279998779296875%
Epoch: 61 | Epoch Time: 0m 48s
Train Loss: 1.3818967755126954 | Train Acc: 50.56599974632263%
Test Loss: 1.389728929901123 | Test Acc: 50.51000118255615%
Epoch: 62 | Epoch Time: 0m 48s
Train Loss: 1.3768376625061036 | Train Acc: 50.764000415802%
Test Loss: 1.385250820159912 | Test Acc: 50.65000057220459%
Epoch: 63 | Epoch Time: 0m 47s
Train Loss: 1.3704857113647462 | Train Acc: 51.05000138282776%
Test Loss: 1.3793616371154784 | Test Acc: 50.88000297546387%
Epoch: 64 | Epoch Time: 0m 47s
Train Loss: 1.364144113922119 | Train Acc: 51.274001598358154%
Test Loss: 1.3733894233703614 | Test Acc: 51.13999843597412%
Epoch: 65 | Epoch Time: 0m 47s
Train Loss: 1.358842250518799 | Train Acc: 51.510000228881836%
Test Loss: 1.3686472648620605 | Test Acc: 51.45999789237976%
Epoch: 66 | Epoch Time: 0m 48s
Train Loss: 1.3528550617980957 | Train Acc: 51.74000263214111%
Test Loss: 1.3631073501586914 | Test Acc: 51.71999931335449%
Epoch: 67 | Epoch Time: 0m 47s
Train Loss: 1.348237212524414 | Train Acc: 51.920002698898315%
Test Loss: 1.3589727081298828 | Test Acc: 51.829999685287476%
Epoch: 68 | Epoch Time: 0m 47s
Train Loss: 1.3432604556274415 | Train Acc: 52.09599733352661%
Test Loss: 1.3544260681152345 | Test Acc: 51.99999809265137%
Epoch: 69 | Epoch Time: 0m 47s
Train Loss: 1.3389018061828613 | Train Acc: 52.24999785423279%
Test Loss: 1.3506822441101074 | Test Acc: 52.27000117301941%
Epoch: 70 | Epoch Time: 0m 48s
Train Loss: 1.3357743212890625 | Train Acc: 52.36600041389465%
Test Loss: 1.348000478363037 | Test Acc: 52.41000056266785%
Epoch: 71 | Epoch Time: 0m 48s
Train Loss: 1.3309129608154298 | Train Acc: 52.48600244522095%
Test Loss: 1.3435851554870606 | Test Acc: 52.46000289916992%
Epoch: 72 | Epoch Time: 0m 47s
Train Loss: 1.3266375286865235 | Train Acc: 52.63400077819824%
Test Loss: 1.340004997253418 | Test Acc: 52.6199996471405%
Epoch: 73 | Epoch Time: 0m 46s
Train Loss: 1.3220202731323243 | Train Acc: 52.82999873161316%
Test Loss: 1.3360227745056152 | Test Acc: 52.68999934196472%
Epoch: 74 | Epoch Time: 0m 56s
Train Loss: 1.3170155857849122 | Train Acc: 53.039997816085815%
Test Loss: 1.3315037223815918 | Test Acc: 52.799999713897705%
Epoch: 75 | Epoch Time: 0m 55s
Train Loss: 1.3128471144104004 | Train Acc: 53.23200225830078%
Test Loss: 1.3279204811096192 | Test Acc: 53.00999879837036%
Epoch: 76 | Epoch Time: 0m 48s
Train Loss: 1.309373350982666 | Train Acc: 53.3519983291626%
Test Loss: 1.3250724479675293 | Test Acc: 53.200000524520874%
Epoch: 77 | Epoch Time: 0m 49s
Train Loss: 1.3057449082946777 | Train Acc: 53.51799726486206%
Test Loss: 1.3218012619018555 | Test Acc: 53.31000089645386%
Epoch: 78 | Epoch Time: 0m 48s
Train Loss: 1.3023543490600586 | Train Acc: 53.68800163269043%
Test Loss: 1.3187924308776855 | Test Acc: 53.450000286102295%
Epoch: 79 | Epoch Time: 0m 48s
Train Loss: 1.2990874922180176 | Train Acc: 53.850001096725464%
Test Loss: 1.3161404602050781 | Test Acc: 53.689998388290405%
Epoch: 80 | Epoch Time: 0m 49s
Train Loss: 1.2955386795043946 | Train Acc: 53.9900004863739%
Test Loss: 1.3132190406799316 | Test Acc: 53.759998083114624%
Epoch: 81 | Epoch Time: 0m 49s
Train Loss: 1.2925563780212401 | Train Acc: 54.14999723434448%
Test Loss: 1.310854721069336 | Test Acc: 53.74000072479248%
Epoch: 82 | Epoch Time: 0m 49s
Train Loss: 1.2889324334716796 | Train Acc: 54.25400137901306%
Test Loss: 1.307563680267334 | Test Acc: 53.79999876022339%
Epoch: 83 | Epoch Time: 0m 48s
Train Loss: 1.2857688775634766 | Train Acc: 54.42399978637695%
Test Loss: 1.3051349555969238 | Test Acc: 53.9900004863739%
Epoch: 84 | Epoch Time: 0m 49s
Train Loss: 1.2827354904174804 | Train Acc: 54.56399917602539%
Test Loss: 1.30270689163208 | Test Acc: 54.11999821662903%
Epoch: 85 | Epoch Time: 0m 49s
Train Loss: 1.2792194886779784 | Train Acc: 54.750001430511475%
Test Loss: 1.299734326171875 | Test Acc: 54.2900025844574%
Epoch: 86 | Epoch Time: 0m 49s
Train Loss: 1.276672877960205 | Train Acc: 54.82400059700012%
Test Loss: 1.2979689071655274 | Test Acc: 54.430001974105835%
Epoch: 87 | Epoch Time: 0m 49s
Train Loss: 1.274504033355713 | Train Acc: 54.94599938392639%
Test Loss: 1.29606402053833 | Test Acc: 54.55999970436096%
Epoch: 88 | Epoch Time: 0m 49s
Train Loss: 1.271900548248291 | Train Acc: 55.0320029258728%
Test Loss: 1.294173422241211 | Test Acc: 54.61000204086304%
Epoch: 89 | Epoch Time: 0m 50s
Train Loss: 1.2695647692871095 | Train Acc: 55.16600012779236%
Test Loss: 1.2924343147277833 | Test Acc: 54.739999771118164%
Epoch: 90 | Epoch Time: 0m 49s
Train Loss: 1.2662360064697267 | Train Acc: 55.250000953674316%
Test Loss: 1.289905168914795 | Test Acc: 54.79000210762024%
Epoch: 91 | Epoch Time: 0m 49s
Train Loss: 1.2628456225585938 | Train Acc: 55.413997173309326%
Test Loss: 1.2871266792297362 | Test Acc: 55.03000020980835%
Epoch: 92 | Epoch Time: 0m 49s
Train Loss: 1.259625658416748 | Train Acc: 55.549997091293335%
Test Loss: 1.2843568443298339 | Test Acc: 54.94999885559082%
Epoch: 93 | Epoch Time: 0m 49s
Train Loss: 1.2575497512817382 | Train Acc: 55.65199851989746%
Test Loss: 1.2828958122253418 | Test Acc: 55.080002546310425%
Epoch: 94 | Epoch Time: 0m 49s
Train Loss: 1.2549680375671386 | Train Acc: 55.786001682281494%
Test Loss: 1.2807864646911622 | Test Acc: 55.12999892234802%
Epoch: 95 | Epoch Time: 0m 48s
Train Loss: 1.2524610548400879 | Train Acc: 55.87800145149231%
Test Loss: 1.2789884536743164 | Test Acc: 55.15999794006348%
Epoch: 96 | Epoch Time: 0m 49s
Train Loss: 1.2497779193115235 | Train Acc: 55.9939980506897%
Test Loss: 1.2767872665405273 | Test Acc: 55.1800012588501%
Epoch: 97 | Epoch Time: 0m 49s
Train Loss: 1.2484330703735351 | Train Acc: 56.06600046157837%
Test Loss: 1.276311785888672 | Test Acc: 55.27999997138977%
Epoch: 98 | Epoch Time: 0m 48s
Train Loss: 1.245792943725586 | Train Acc: 56.18399977684021%
Test Loss: 1.274269955444336 | Test Acc: 55.34999966621399%
Epoch: 99 | Epoch Time: 0m 48s
Train Loss: 1.2434895935058594 | Train Acc: 56.30199909210205%
Test Loss: 1.272636449432373 | Test Acc: 55.51000237464905%
Epoch: 100 | Epoch Time: 0m 49s
Train Loss: 1.241371303253174 | Train Acc: 56.46600127220154%
Test Loss: 1.2714114921569823 | Test Acc: 55.479997396469116%
